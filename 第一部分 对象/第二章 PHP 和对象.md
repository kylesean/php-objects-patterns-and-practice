对象一开始并不是 PHP 项目的关键，它是 PHP 创建者们后来才想要到要引进的。

引进对象的想法被证明是非常正确的。本章总结了 PHP 面向对象特性的发展过程，逐步介绍对象的概念。本章包括以下内容：
- PHP/FI 2.0：我们所不知道的 PHP。
- PHP 3：对象的首次出现。 
- PHP 4: 面向对象编程的发展。
- PHP 5：对象成为 PHP 的核心部分。
- PHP 7：缩小差距，提升性能

### PHP 对象的偶然成功
很对面向对象风格的 PHP 类库和程序在广泛流传，说明了对象对于 PHP 的重要性。PHP5 对于面向对象开发的加强，看上去像一个自然和不可避免的结果。实际上，事实并非如此。

#### 最初：PHP/FI
正如我们今天知道的那样，PHP 起源于 `Rasmus Lerdorf` 用 Perl 开发的工具。PHP 是 `Personal Homepage Tool` 的简写，意为“个人主页工具”，而 FI 即 `Form Interpreter`，意为“表单解释器”。结合这两种工具形成的宏命令可用来发送 SQL 语句到数据库、处理表单和流控制。

这两个工具用 C 语言重写后组成了 PHP/FI 2.0。这个时期的 PHP 看上去和现在的语法不太一样，但本质上没有太大的不同。它支持变量、关联数组和函数。当然，那时还没有对象。

#### 语法糖：PHP 3
事实上，在 PHP3 的计划阶段，对象并不安排之中。和今天的 PHP 一样，PHP3的主要架构设计师也是 `Zeev Suraski` 和 `Andi Gutmans`。PHP3 是由 PHP/FI 2.0 完全重写的，但是对象并不是新语法中必需的部分。

据 `Zeev Suraski` 回忆，PHP 对类的支持实际上是后来才进去的（准确地说是 1997 年 8 月 27 日）。那时的类和对象实际上是定义和存取关联数组的另一种方式。

当然，加入了方法和继承使得类比关联数组更加强大，但那时对类的操作仍然存在很多局限性，比如不能访问父类中被覆盖的方法（如果你不明白这里的意思也不用担心，我们将在后面解释）。另一个不足之处是对象在 PHP 脚本中被传递的方式并非最佳，我们马上就会讲到。
在这个时期对象只是边缘话题，在官方文档中也没有提及这方面内容。PHP 手册只用了一句话和一段代码示例来介绍对象，而且该示例没有介绍对象的继承和属性等。

#### 一场静悄悄的革命
PHP4 可算是夯实 PHP 基础的另一个阶段，因此此时 PHP 大部分核心代码都被重写了。Zend 引擎（由 Zeev 和 Andi 而得名）开始为 PHP 提供强大动力。Zend 引擎是 PHP 的主要组成部分之一。任何你可能调用到的 PHP 函数都是高级扩展层的一部分，它们一般都是根据所完成的工作来命名的，比如和数据库 API 对话或者转换字符串。Zend 引擎管理内存，将控制交由其他组件，并将我们所熟知的每天使用的 PHP 语法转换为可执行的字节码（bytecode），而且类也是由 Zend 引擎引入 PHP 的核心特性。

客观地说，在 PHP4 中，我们可以在子类中覆盖并访问父类的方法，这是一个很大的进步。
然而主要的不足依然存在。把对象赋值给变量，传递对象到函数，或从方法返回对象，结果都会创建对象的副本。所以这样的赋值：
```
$my_obj = new User('bob');
$other = $my_obj;
```
将导致同时存在两个 User 对象，而不是同一个 User 对象的两个引用。在大多数面向对象语言中，我们一直都是按引用传递对象，而不是像这里这样按值传递。也就是说，只传递指向对象的引用，而不是对象的副本。默认按值传送的行为导致了很多不明显的 bug，因为程序员可能会无意识地在脚本的某个部分修改了对象，而希望在其他的引用上看到了改变（实际上在其他引用上却没有任何改变）。在本书中，我们将看到很多对同一个对象进行多次引用的例子。

幸运的是，PHP4 中存在强制按引用传递的方式，但是它需要使用一种看起来很笨的语法。

按引用赋值：

```
$other = & $my_obj;
// $other 和 $my_boj 指向相同对象
```
按引用传递：
```
function setSchool(& $school) 
{
    // $school现在是被传递对象的引用而不是副本    
}
```
按引用返回：
```
function & $getSchool()
{
   // 返回一个引用而不是副本
   return $this->school;
}
```
尽管这样也可以正常工作，但是程序员很容易忘记使用 `&` 符号，容易使 bug 蔓延到面向对象的代码中。而且这样的代码不会报错，加上导致错误的代码看上去好像还很合理，所以很难追踪到 bug。
这时 PHP 手册中不仅包括语法，还特别增加了对象方面的内容，并且面向对象的代码开始成为主流。对象在 PHP 中并非没有引起争论（显然现在还是这样），像 “我需要对象吗” 这样的论调在邮件列表中是很常见的。Zend 站点也将支持面向对象程序设计和其他持反对意见的文章放在了一起。

尽管按引用传递的观点存在争论，许多程序员还是在他们的代码中加入了 `&` 符号。面向对象的 PHP 逐渐流行。就像 `Zeev Suraski` 在 DevX.com 上写的一篇文章（[http://www.devx.com/webdev/Article/10007](http://www.devx.com/webdev/Article/10007)）中所说的那样：

PHP 历史上最大的一个进步就是对于面向对象编程的支持（尽管功能不多，还存在一些问题和限制），并且面向对象已成为最流行的开发方式。这个趋势，是我们没有预料到的。目前我们没有为 PHP 设计充足的面向对象开发功能，所以在这方面 PHP 显得不那么让人满意。现在 PHP 中的对象与其他面向对象语言中真正的对象不同，它更像是关联数组。

像第一章所说的那样，很多站点和在线文章开始对面向对象设计产生浓厚的兴趣。PHP 的官方代码库 PEAR 本身就使用了面向对象设计。在扩展 PHP 功能的 PEAR 代码包中，我们可以找到一些面向对象设计模式的最佳示例。

也许有人会认为 PHP 是迫于不可避免的外部压力才支持面向对象的。值得注意的是，虽然面向对象编程在 20 世界 60 年代就已经出现，但是从 20 世纪 90 年代中期才开始发展。最为流行的 Java 直到 1995 年才发布。面向过程的语言 C 的扩展版 C++ 则在 1979 年才开始出现。经过长时间的发展，C++ 在 20 世纪 90 年代有才了真正的飞跃。Perl 5 在 1994 年发布，新的变革使得这个曾经是面向过程的语言也支持了面向对象（虽然有些人认为 Perl 面向对象的支持是后来才想到的）。作为一个面向过程的小型语言，PHP 迅速地实现了面向对象的支持，这显示了 PHP 对用户需求的切实考虑。